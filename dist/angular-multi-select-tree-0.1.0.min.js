!function(){"use strict";angular.module("multi-select-tree",[])}(),function(){"use strict";var e=angular.module("multi-select-tree");e.controller("multiSelectTreeCtrl",["$scope","$document",function(e,t){function l(){c(),e.$apply()}function c(){e.showTree=!1,o&&(o.isActive=!1,o=void 0),t.off("click",l)}function i(t){for(var l=0,c=t.length;c>l;l++)n(t[l])||t[l].selected!==!0?n(t[l])&&t[l].selected===!1&&(t[l].selected=!0):e.selectedItems.push(t[l]),t[l]&&t[l].children&&i(t[l].children)}function n(t){var l=!1;if(e.selectedItems)for(var c=0;c<e.selectedItems.length;c++)if(e.selectedItems[c].id===t.id){l=!0;break}return l}var o;e.showTree=!1,e.selectedItems=[],e.multiSelect=e.multiSelect||!1,e.onActiveItem=function(e){o!==e&&(o&&(o.isActive=!1),o=e,o.isActive=!0)},e.refreshOutputModel=function(){e.outputModel=angular.copy(e.selectedItems)},e.refreshSelectedItems=function(){e.selectedItems=[],e.inputModel&&i(e.inputModel)},e.deselectItem=function(t,l){l.stopPropagation(),e.selectedItems.splice(e.selectedItems.indexOf(t),1),t.selected=!1,this.refreshOutputModel()},e.onControlClicked=function(c){c.stopPropagation(),e.showTree=!e.showTree,e.showTree&&t.on("click",l)},e.onFilterClicked=function(e){e.stopPropagation()},e.clearFilter=function(t){t.stopPropagation(),e.filterKeyword=""},e.canSelectItem=function(t){return e.callback({item:t,selectedItems:e.selectedItems})},e.switchCurrentView=function(t){t.stopPropagation(),e.switchViewCallback({scopeObj:e})},e.itemSelected=function(t){if(!(e.useCallback&&e.canSelectItem(t)===!1||e.selectOnlyLeafs&&t.children&&t.children.length>0)){if(e.multiSelect){t.selected=!0;var l=e.selectedItems.indexOf(t);n(t)?(t.selected=!1,e.selectedItems.splice(l,1)):e.selectedItems.push(t)}else{c();for(var i=0;i<e.selectedItems.length;i++)e.selectedItems[i].selected=!1;t.selected=!0,e.selectedItems=[],e.selectedItems.push(t)}this.refreshOutputModel()}}}]),e.directive("multiSelectTree",function(){return{restrict:"E",templateUrl:"src/multi-select-tree.tpl.html",scope:{inputModel:"=",outputModel:"=?",multiSelect:"=?",switchView:"=?",switchViewLabel:"@",switchViewCallback:"&",selectOnlyLeafs:"=?",callback:"&",defaultLabel:"@"},link:function(e,t,l){function c(e,t){for(var l=i(e,[]),c=0,n=l.length;n>c;c++)if(-1!==l[c].name.toLowerCase().indexOf(t.toLowerCase()))return!1;return!0}function i(e,t){for(var l=0;l<e.children.length;l++)t.push(e.children[l]),i(e.children[l],t);return t}l.callback&&(e.useCallback=!0),e.$watch("inputModel",function(t){t&&(e.refreshSelectedItems(),e.refreshOutputModel())}),e.$watch("filterKeyword",function(){void 0!==e.filterKeyword&&angular.forEach(e.inputModel,function(t){-1!==t.name.toLowerCase().indexOf(e.filterKeyword.toLowerCase())?t.isFiltered=!1:c(t,e.filterKeyword)?t.isFiltered=!0:t.isFiltered=!1})})},controller:"multiSelectTreeCtrl"}})}(),function(){"use strict";var e=angular.module("multi-select-tree");e.controller("treeItemCtrl",["$scope",function(e){e.item.isExpanded=!1,e.showExpand=function(e){return e.children&&e.children.length>0},e.onExpandClicked=function(e,t){t.stopPropagation(),e.isExpanded=!e.isExpanded},e.clickSelectItem=function(t,l){l.stopPropagation(),e.itemSelected&&e.itemSelected({item:t})},e.subItemSelected=function(t,l){e.itemSelected&&e.itemSelected({item:t})},e.activeSubItem=function(t,l){e.onActiveItem&&e.onActiveItem({item:t})},e.onMouseOver=function(t,l){l.stopPropagation(),e.onActiveItem&&e.onActiveItem({item:t})},e.showCheckbox=function(){return e.multiSelect?e.selectOnlyLeafs?!1:e.useCallback?e.canSelectItem(e.item):void 0:!1}}]),e.directive("treeItem",["$compile",function(e){return{restrict:"E",templateUrl:"src/tree-item.tpl.html",scope:{item:"=",itemSelected:"&",onActiveItem:"&",multiSelect:"=?",selectOnlyLeafs:"=?",isActive:"=",useCallback:"=",canSelectItem:"="},controller:"treeItemCtrl",compile:function(t,l,c){angular.isFunction(c)&&(c={post:c});var i,n=t.contents().remove();return{pre:c&&c.pre?c.pre:null,post:function(t,l,o){i||(i=e(n)),i(t,function(e){l.append(e)}),c&&c.post&&c.post.apply(null,arguments)}}}}}])}();